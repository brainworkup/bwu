# Emotional/Behavioral/Personality {#sec-emotion}

{{< include _02-10_emotion_text.qmd >}}

```{r}
#| label: data-emotion
library(bwu)
pheno <- "emotion"
data <- bwu::read_data(pheno = pheno)
domains <- c(
  "Psychiatric Disorders", "Personality Disorders", "Substance Use",
  "Psychosocial Problems", "Behavioral/Emotional/Social"
)
scales <- c(
  "Activity Level",
  "Affective (A)",
  "Affective (D)",
  "Affective Instability",
  "Aggression",
  "Aggressive Attitude",
  "ALC Estimated Score",
  "Alcohol Problems",
  "Antisocial Behaviors",
  "Antisocial Features",
  "Anxiety-Related Disorders",
  "Anxiety",
  "Borderline Features",
  "Cognitive (A)",
  "Cognitive (D)",
  "Conversion",
  "Depression",
  "Dominance",
  "DRG Estimated Score",
  "Drug Problems",
  "Egocentricity",
  "Grandiosity",
  "Health Concerns",
  "Hypervigilance",
  "Identity Problems",
  "Irritability",
  "Mania",
  "Negative Relationships",
  "Nonsupport",
  "Obsessive-Compulsive",
  "Paranoia",
  "Persecution",
  "Phobias",
  "Physical Aggression",
  "Physiological (A)",
  "Physiological (D)",
  "Psychotic Experiences",
  "Resentment",
  "Schizophrenia",
  "Self-Harm",
  "Social Detachment",
  "Somatic Complaints",
  "Somatization",
  "Stimulus-Seeking",
  "Stress",
  "Suicidal Ideation",
  "Thought Disorder",
  "Traumatic Stress",
  "Treatment Rejection",
  "Verbal Aggression",
  "Warmth",
  "BAI-2 Total Score",
  "BID-2 Total Score",
  "Activities of Daily Living",
  "Adaptability",
  "Adaptive Skills",
  "Aggression",
  "Anxiety",
  "Attention Problems",
  "Attitude to School",
  "Attitude to Teachers",
  "Atypicality",
  "Behavioral Symptoms Index",
  "Conduct Problems",
  "Depression",
  "Emotional Symptoms Index",
  "Externalizing Problems",
  "Functional Communication",
  "Hyperactivity",
  "Inattention/Hyperactivity",
  "Internalizing Problems",
  "Interpersonal Relations",
  "Leadership",
  "Locus of Control",
  "Personal Adjustment",
  "Relations with Parents",
  "School Problems",
  "Self-Esteem",
  "Self-Reliance",
  "Sensation Seeking",
  "Sense of Inadequacy",
  "Social Skills",
  "Social Stress",
  "Somatization",
  "Withdrawal"
)
data <-
  bwu::filter_data(
    data,
    domain = domains,
    scale = scales
  )
```

```{r}
#| label: text-emotion
#| cache: true
bwu::cat_neuropsych_results(data = data, file = "_02-10_emotion_text.qmd")
```

```{r}
#| label: qtbl-emotion
#| dev: tikz
#| fig-process: pdf2png
#| eval: false
options(tikzDefaultEngine = "xetex")

# footnotes
fn_t_score <- gt::md("*T*-Score: Mean = 50 [50th‰], SD ± 10 [16th‰, 84th‰]")

pheno <- "emotion"
table_name <- "table_emotion"
grp_emotion <- list(
  t_score = c("PAI", "BASC-3 PRS", "BASC-3 SRP", "BASC-3 TRS")
)
vertical_padding <- 0.05

data2 <-
  dplyr::filter(data, domain %in% c(
    "Psychiatric Disorders",
    "Personality Disorders",
    "Substance Use",
    "Behavioral/Emotional/Social"
  )) |>
  dplyr::arrange(test_name) |>
  dplyr::arrange(subdomain) |>
  dplyr::arrange(absort)
```

```{r}
#| label: qtbl-emotion-2
#| dev: tikz
#| fig-process: pdf2png
#| eval: false
options(tikzDefaultEngine = "xetex")

# PAI
data_emotion <- data2[, c(10, 1, 3, 4, 5)]
colnames(data_emotion)[1] <- "test_name"
data3 <- data_emotion

bwu::tbl_gt(
  data = data3,
  pheno = pheno,
  table_name = table_name,
  dynamic_grp = grp_emotion,
  vertical_padding = vertical_padding,
  multiline = FALSE
)
```

```{r}
#| label: qtbl-basc3
#| dev: tikz
#| fig-process: pdf2png
#| eval: false
options(tikzDefaultEngine = "xetex")

# BASC-3

data_emotion <- data2[, c(7, 1, 3, 4, 8, 10)]
data3 <- data_emotion

bwu::tbl_gt(
  data = data3,
  pheno = pheno,
  table_name = table_name,
  dynamic_grp = grp_emotion,
  vertical_padding = vertical_padding,
  multiline = FALSE
)
```

```{r}
#| label: pai-tables
#| eval: false

tbl1 <-
  dplyr::filter(data_emotion, domain == "Psychiatric Disorders") |>
  dplyr::arrange(test_name) |>
  dplyr::arrange(subdomain)
tbl1 <- tbl1[, c(11, 2, 4, 5, 6)]
colnames(tbl1)[1] <- "test_name"
# table_psych <- bwu::tbl_gt(
#   tbl1,
#   table_name = "table_psych",
#   source_note = source_note
# )

tbl2 <-
  dplyr::filter(data_emotion, domain == "Personality Disorders") |>
  dplyr::arrange(test_name) |>
  dplyr::arrange(subdomain)
tbl2 <- tbl2[, c(11, 2, 4, 5, 6)]
colnames(tbl2)[1] <- "test_name"
# table_personality <- bwu::tbl_gt(
#   tbl2,
#   table_name = "table_personality",
#   source_note = source_note
# )

tbl3 <-
  dplyr::filter(data_emotion, domain == "Substance Use") |>
  dplyr::arrange(test_name) |>
  dplyr::arrange(subdomain)
tbl3 <- tbl3[, c(11, 2, 4, 5, 6)]
colnames(tbl3)[1] <- "test_name"
# table_sud <- bwu::tbl_gt(
#   tbl3,
#   table_name = "table_sud",
#   source_note = source_note
# )

tbl4 <-
  dplyr::filter(data_emotion, domain == "Psychosocial Problems") |>
  dplyr::arrange(test_name) |>
  dplyr::arrange(subdomain)
tbl4 <- tbl4[, c(11, 2, 4, 5, 6)]
colnames(tbl4)[1] <- "test_name"
# table_social <- bwu::tbl_gt(
#   tbl4,
#   table_name = "table_social",
#   source_note = source_note
# )
```

```{r}
#| label: fig-emotion
#| fig-cap: "Mood/Self-Report"

# Arguments
pheno <- "emotion"
emotion <-
  dplyr::filter(data) |>
  dplyr::filter(domain %in% c(
    "Psychiatric Disorders", "Personality Disorders",
    "Substance Use", "Behavioral/Emotional/Social"
  ))

data <- emotion
x <- data$z_mean_subdomain
y <- data$subdomain
colors <- NULL
# return_plot <- FALSE
return_plot <- Sys.getenv("RETURN_PLOT")
filename <- "fig_emotion.svg"

# Make dotplot
bwu::dotplot(
  data = data,
  x = x,
  y = y,
  colors = colors,
  return_plot = return_plot,
  filename = filename
)
```

```{=typst}
#let domain(file_fig) = {
  let font = (font: "Fira Sans", size: 9pt)
  set text(..font)
figure([#image(file_fig, width: auto)],
  placement: none,
  caption: figure.caption(position: bottom, [Emotional/Behavioral/Personality]),
  kind: "image",
  supplement: [*Fig.*],
  gap: 0.5em,
  )
}
```

```{=typst}
#let file_fig = "_02-10_emotion_files/figure-typst/fig-emotion-1.svg"
#domain(
  file_fig
)
```
